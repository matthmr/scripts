#!/usr/bin/sh

WM=$1
TERM=st
TIMEOUT=5

# wait for X to start, if it hasn't yet, keep waiting...
sleep $TIMEOUT
while :
do
  pidof $WM > /dev/null && break || sleep $TIMEOUT
done

# start WM-specific programs
case $WM in
  'DISABLED')
    # See (20221106)
    #/tmp/dbus-launch /mnt/ssd/root/usr/bin/dunst < /dev/null >& /dev/null &
    xsetroot -xcf /home/mh/.icons/McMojave-cursors/cursors/default 32 &;;
esac

if [[ $2 = "" ]]; then
  exit 0
fi

# execute the session script
if [[ -f /tmp/xsession.lock ]]; then
  exit 0
else
  touch /tmp/xsession.lock

  if [[ ! -z $2 ]]; then
    export XINITSLEEP=/home/mh/Scripts/system/linux.sh
    $TERM -e zsh
  fi
fi
